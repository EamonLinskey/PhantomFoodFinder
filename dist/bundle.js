(()=>{var e={386:e=>{function t(e,t){if((e=e.replace(/\s+/g,""))===(t=t.replace(/\s+/g,"")))return 1;if(e.length<2||t.length<2)return 0;let n=new Map;for(let t=0;t<e.length-1;t++){const r=e.substring(t,t+2),o=n.has(r)?n.get(r)+1:1;n.set(r,o)}let r=0;for(let e=0;e<t.length-1;e++){const o=t.substring(e,e+2),i=n.has(o)?n.get(o):0;i>0&&(n.set(o,i-1),r++)}return 2*r/(e.length+t.length-2)}e.exports={compareTwoStrings:t,findBestMatch:function(e,n){if(!function(e,t){return"string"==typeof e&&!!Array.isArray(t)&&!!t.length&&!t.find((function(e){return"string"!=typeof e}))}(e,n))throw new Error("Bad arguments: First argument should be a string, second should be an array of strings");const r=[];let o=0;for(let i=0;i<n.length;i++){const a=n[i],s=t(e,a);r.push({target:a,rating:s}),s>r[o].rating&&(o=i)}return{ratings:r,bestMatch:r[o],bestMatchIndex:o}}}},946:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.seeIfStreeNumberMatches=t.getLatAndLong=void 0;const o=n(708),i=n(117);t.getLatAndLong=()=>r(void 0,void 0,void 0,(function*(){const e=yield(0,o.waitForElm)('script[type="application/ld+json"]');if(!e||null===e.textContent)return null;const t=JSON.parse(e.textContent);return{latitude:t.geo.latitude,longitude:t.geo.longitude}})),t.seeIfStreeNumberMatches=(e,t)=>{var n,r;return(null===(n=e.match(i.firstNumberRegex))||void 0===n?void 0:n[0])===(null===(r=t.match(i.firstNumberRegex))||void 0===r?void 0:r[0])}},444:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AddBadgeHTMLtoTarget=void 0;const n=new Map(Object.entries({confirmedGhostKitchen:{emoji:"👻",badgeClass:"PFF-haunted-text",badgeText:"Haunted Kitchen"},confirmedRealKitchen:{emoji:"✔️",badgeClass:"PFF-ghost-free-text",badgeText:"Ghost-Free Kitchen"},unconfirmedKitchen:{emoji:"❓",badgeClass:"PFF-potentially-haunted-text",badgeText:"Unverified"}}));t.AddBadgeHTMLtoTarget=(e,t,r,o="h1")=>{const i=document.querySelector(o);if(!i)return;i.style.display="flex",i.style.alignItems="center";const{emoji:a,badgeClass:s,badgeText:c}=n.get(t),u=`https://www.google.com/maps/place/${e.length>0?e[0].vicinity:r.address.streetAddress}`;let l;l="confirmedRealKitchen"===t?`\n            ${e[0].name} confirmed to exixst at \n            <a target='_blank' href='${u}'>\n                this location\n            </a>`:"confirmedGhostKitchen"===t?`\n            "${r.name}" not verified at\n            <a target='_blank' href='${u}'>\n                this location.\n            </a>\n            </span>\n            <div class='PFF-mt-1 PFF-max-content'>\n                Other businesses at this location:\n            </div>\n            <ul>\n                ${e.map((e=>`<li>${e.name}</li>`)).join("")}\n            </ul>`:`\n            There are no resturants verified at\n            <a target='_blank' href='${u}'>\n                this location.\n            </a>\n            This may be due to google maps data not being up to date, or the address data being incorrect`,i.innerHTML+=`\n        <span class="PFF-tooltip">\n            <div class="PFF-kitchen-text ${s}">${c}</div>\n            <div  class="PFF-kitchen-emoji">${a}</div>\n            <span class="PFF-tooltip-text">\n                <span class='PFF-max-content PFF-display-block'> \n                    ${l}\n                </span>\n            </span>\n        </span>`}},837:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getOrInitilizeRestaurantMap=t.updateRestaurantCache=t.getCachedRestaurantData=void 0,t.getCachedRestaurantData=e=>n(void 0,void 0,void 0,(function*(){var n;return null!==(n=(yield(0,t.getOrInitilizeRestaurantMap)()).get(r(e)))&&void 0!==n?n:null})),t.updateRestaurantCache=(e,o)=>n(void 0,void 0,void 0,(function*(){if(0===o.length)return;const n=yield(0,t.getOrInitilizeRestaurantMap)();n.set(r(e),o),yield chrome.storage.local.set({restaurantData:Object.fromEntries(n)})})),t.getOrInitilizeRestaurantMap=()=>n(void 0,void 0,void 0,(function*(){const e=yield chrome.storage.local.get("restaurantData");if(null==e?void 0:e.restaurantData)return new Map(Object.entries(e.restaurantData));const t=new Map;return chrome.storage.local.set({restaurantData:t}),t}));const r=e=>`${e.latitude}${e.longitude}`},740:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.checkForGhostKitchens=t.identifyKitchenType=void 0;const o=n(708),i=n(837),a=n(558),s=n(946),c=n(444),u=n(876);t.identifyKitchenType=(e,t)=>0===e.length?(0,c.AddBadgeHTMLtoTarget)(e,"unconfirmedKitchen",t):e.map((e=>Object.assign(Object.assign({},e),{score:(0,u.scoreRestaurantNameSimilarities)(e.name,t.name)}))).sort(((e,t)=>t.score-e.score))[0].score>.75?(0,c.AddBadgeHTMLtoTarget)(e,"confirmedRealKitchen",t):(0,c.AddBadgeHTMLtoTarget)(e,"confirmedGhostKitchen",t);const l=e=>r(void 0,void 0,void 0,(function*(){const n=yield(0,o.waitForElm)('script[type="application/ld+json"]');if(!n||null===n.textContent)return;const r=JSON.parse(n.textContent),i=r.address.streetAddress;let a=e.filter((e=>e.vicinity.includes(i)));0===a.length&&(a=e.filter((e=>(0,s.seeIfStreeNumberMatches)(e.vicinity,i)))),a.length,(0,t.identifyKitchenType)(a,r)}));t.checkForGhostKitchens=()=>r(void 0,void 0,void 0,(function*(){let e=yield(0,s.getLatAndLong)();if(null===e)return;let{latitude:t,longitude:n}=e;const o=yield(0,i.getCachedRestaurantData)(e);o?l(o):t&&n&&chrome.runtime.sendMessage({type:"getNearbyRestaurants",cordinate:{latitude:t,longitude:n}},(t=>r(void 0,void 0,void 0,(function*(){(0,a.isErrorResponse)(t)?console.error(t.error):(l(t),yield(0,i.updateRestaurantCache)(e,t))}))))}))},708:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.waitForElm=void 0,t.waitForElm=e=>new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const n=new MutationObserver((()=>{document.querySelector(e)&&(t(document.querySelector(e)),n.disconnect())}));n.observe(document.body,{childList:!0,subtree:!0})}))},706:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),(0,n(740).checkForGhostKitchens)()},117:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonConjunctionsRegex=t.insideParensOrBracketsRegex=t.firstNumberRegex=t.nonAphaNumericRegex=void 0,t.nonAphaNumericRegex=/[^A-Za-z0-9]/g,t.firstNumberRegex=/\d+/,t.insideParensOrBracketsRegex=/\s*[\[{(<].*?[>)}\]]\s*/g,t.commonConjunctionsRegex=/(and|or|slash|with|plus|minus)/gi},876:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.scoreRestaurantNameSimilarities=void 0;const o=r(n(386)),i=n(117);t.scoreRestaurantNameSimilarities=(e,t)=>{const n=a(e),r=a(t);if(0===n.length||0===r.length)return o.default.compareTwoStrings(e,t);const i=o.default.compareTwoStrings(n,r),c=s(n),u=s(r);if(0===c.length||0===u.length)return o.default.compareTwoStrings(c,u);const l=o.default.compareTwoStrings(c,u);return Math.max(i,l)};const a=e=>(e=(e=e.replace(i.insideParensOrBracketsRegex,"")).replace(i.nonAphaNumericRegex,"")).toLowerCase(),s=e=>e.replace(i.commonConjunctionsRegex,"")},385:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const o=n(558);chrome.runtime.onMessage.addListener(((e,t,n)=>{var i;return"getNearbyRestaurants"===e.type&&(i=e.cordinate,r(void 0,void 0,void 0,(function*(){const e=`https://maps.googleapis.com/maps/api/place/nearbysearch/json?fields=name&location=${i.latitude},${i.longitude}&radius=20&key=`,t=yield fetch(e);if(!t.ok){const e="Unable to connect to the google place API";throw console.error(e),new Error(e)}const n=yield t.json();if(!o.sucessfulCallStatuses.includes(n.status)){const e=`There was a problem with our request the google place API. Response: "${n.status}"`;throw console.error(e),new Error(e)}return(null==n?void 0:n.results)&&n.results.length>0?n.results:null}))).then((e=>{n(e)})).catch((e=>{const t=`Error retrieving restaurant name: ${e}`;console.error(t),n({error:t})})),!0}))},558:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isErrorResponse=t.sucessfulCallStatuses=void 0,t.sucessfulCallStatuses=["OK","ZERO_RESULTS"],t.isErrorResponse=function(e){return"object"==typeof e&&null!==e&&"error"in e&&"string"==typeof e.error}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(()=>{"use strict";n(946),n(444),n(837),n(740),n(708),n(706),n(117),n(876),n(385),n(558)})()})();